function k(){const c=document.querySelector(".searchable-dropdown:not([data-initialized])");if(!c)return;c.setAttribute("data-initialized","true");const l=document.getElementById("patient_search_input"),r=document.getElementById("patient_id_hidden"),n=document.getElementById("patient_options_container");if(!l||!n)return;const A=n.querySelectorAll(".option"),S=c.dataset.selectUrl;let s=-1;n.style.display="none";const a=()=>{n.querySelectorAll(".option").forEach(e=>e.classList.remove("active"))},g=e=>{a();const t=Array.from(n.querySelectorAll(".option")).filter(E=>E.style.display!=="none");if(t.length===0)return;s=(e+t.length)%t.length;const o=t[s];o.classList.add("active"),o.scrollIntoView({block:"nearest",behavior:"smooth"})},d=()=>{const e=l.value.toLowerCase();let t=0;A.forEach(o=>{const w=(o.textContent||o.innerText).toLowerCase().includes(e);o.style.display=w?"block":"none",w&&t++}),s=-1,a(),n.style.display=t>0?"block":"none"};l.addEventListener("focus",d),l.addEventListener("blur",()=>setTimeout(()=>{document.activeElement!==l&&!n.contains(document.activeElement)&&(n.style.display="none")},150)),l.addEventListener("keyup",e=>{["ArrowUp","ArrowDown","Enter"].includes(e.key)||d()});const u=()=>{l.value===""?(r&&(r.value=""),i(!0),I()):r&&r.value===""&&i(!0)};l.addEventListener("input",u),l.addEventListener("change",u);const p=e=>{if(!e)return;const t=e.getAttribute("data-value"),o=(e.textContent||e.innerText).trim();l.value=o,r&&(r.value=t),n.style.display="none",s=-1,a(),i(!1),document.dispatchEvent(new CustomEvent("patient:selected",{bubbles:!0,detail:{patientId:r.value,selectUrl:S}}))};l.addEventListener("keydown",e=>{const t=Array.from(n.querySelectorAll(".option")).filter(o=>o.style.display!=="none");if(["ArrowDown","ArrowUp"].includes(e.key))e.preventDefault(),g(s+(e.key==="ArrowDown"?1:-1));else if(e.key==="Enter"){e.preventDefault();const o=n.querySelector(".option.active");p(o||(t.length>0?t[0]:null))}}),n.addEventListener("mousedown",e=>{const t=e.target.closest(".option");t&&(p(t),e.preventDefault())});const f=document.querySelector("#adl-form fieldset"),y=document.getElementById("date_selector"),m=document.getElementById("day_no_selector"),v=document.querySelectorAll(".cdss-input.vital-input"),b=document.querySelector("#adl-form button.button-default:nth-of-type(1)"),h=document.querySelector("#adl-form button[type='submit']");document.querySelectorAll(".alert-box");const i=e=>{f&&(f.disabled=e),y&&(y.disabled=e),m&&(m.disabled=e),v.forEach(t=>{t.disabled=e}),b&&(b.disabled=e),h&&(h.disabled=e)},I=()=>{v.forEach(e=>{e.value="",e.style.backgroundColor="",e.style.color=""}),L()},L=()=>{document.querySelectorAll(".alert-box").forEach(t=>{t.innerHTML='<span class="opacity-70 text-white font-semibold">NO ALERTS</span>',t.style.backgroundColor="",t.onclick=null})};r&&r.value===""?i(!0):i(!1)}window.initializeSearchableDropdown=k;
