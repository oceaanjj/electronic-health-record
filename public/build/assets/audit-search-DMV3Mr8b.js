document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("audit-search"),e=document.getElementById("audit-table-body"),s=document.getElementById("audit-loading");if(!t||!e)return;let r;t.addEventListener("input",()=>{clearTimeout(r),r=setTimeout(()=>{const o=t.value.trim(),n=new URL(window.location.href);o?n.searchParams.set("username_search",o):n.searchParams.delete("username_search"),s.classList.remove("hidden"),e.style.transition="opacity 0.4s ease",e.style.opacity=.3,fetch(n.toString(),{headers:{"X-Requested-With":"XMLHttpRequest"}}).then(a=>a.text()).then(a=>{const i=new DOMParser().parseFromString(a,"text/html").querySelector("#audit-table-body");i&&(e.innerHTML=i.innerHTML,e.style.opacity=0,requestAnimationFrame(()=>{e.style.transition="opacity 0.4s ease",e.style.opacity=1}))}).catch(()=>console.error("Search failed")).finally(()=>{setTimeout(()=>s.classList.add("hidden"),300)})},400)})});
