document.addEventListener("DOMContentLoaded",function(){if(!document.querySelector(".searchable-dropdown"))return;const o=document.getElementById("patient_search_input"),a=document.getElementById("patient_id_hidden"),n=document.getElementById("patient_options_container"),s=n.querySelectorAll(".option"),d=document.getElementById("patient-select-form");n.style.display="none";const c=()=>{const e=o.value.toLowerCase().trim();s.forEach(t=>{const i=(t.textContent||t.innerText).toLowerCase().trim();t.style.display=i.includes(e)?"block":"none"})};o.addEventListener("focus",()=>{c(),n.style.display="block"}),o.addEventListener("keyup",c);const r=e=>{const t=e.getAttribute("data-value"),i=(e.textContent||e.innerText).trim();o.value=i,a.value=t,n.style.display="none",d&&d.submit()};o.addEventListener("keydown",e=>{if(e.key==="Enter"){e.preventDefault();const t=n.querySelector('.option[style*="block"]');t&&r(t)}}),s.forEach(e=>{e.addEventListener("click",()=>{r(e)})}),document.addEventListener("click",e=>{e.target.closest(".searchable-dropdown")||(n.style.display="none")})});
